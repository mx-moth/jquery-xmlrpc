(function(e){"use strict";var t=function(){Error.apply(this,arguments)};t.prototype=new Error;t.prototype.type="XML-RPC fault";var n=e.xmlrpc=function(t,r){if(arguments.length===2){r.url=t}else{r=t;t=r.url}r.dataType="xml json";r.type="POST";r.contentType="text/xml";r.converters={"xml json":n.parseDocument};var i=n.document(r.methodName,r.params||[]);var s=new XMLSerializer;r.data=s.serializeToString(i);return e.ajax(r)};n.createXMLDocument=function(){if(document.implementation&&"createDocument"in document.implementation){return document.implementation.createDocument(null,null,null)}else{var e,t,n=["MSXML6.DomDocument","MSXML3.DomDocument","MSXML2.DomDocument","MSXML.DomDocument","Microsoft.XmlDom"];for(e=0,t=n.length;e<t;e++){try{return new ActiveXObject(n[e])}catch(r){}}}};n.document=function(t,r){var i=n.createXMLDocument();var s=function(t){return e(i.createElement(t))};var o=s("methodName").text(t);var u=s("params").append(e.map(r,function(e){var t=s("value").append(n.toXmlRpc(e,s));return s("param").append(t)}));var a=s("methodCall").append(o,u);i.appendChild(a.get(0));return i};var r=function(e){return e===parseInt(e,10)&&!isNaN(e)};n.toXmlRpc=function(t,n){if(t instanceof i){return t.toXmlRpc(n)}var s=e.xmlrpc.types;var o=e.type(t);switch(o){case"undefined":case"null":return s.nil.encode(t,n);case"date":return s["datetime.iso8601"].encode(t,n);case"object":if(t instanceof ArrayBuffer){return s.base64.encode(t,n)}else{return s.struct.encode(t,n)}break;case"number":if(r(t)){return s["int"].encode(t,n)}else{return s["double"].encode(t,n)}break;case"array":case"boolean":case"string":return s[o].encode(t,n);default:throw new Error("Unknown type",t)}};n.parseDocument=function(r){var i=e(r);var s=i.children("methodresponse");var o=s.find("> fault");if(o.length===0){var u=s.find("> params > param > value > *");var a=u.toArray().map(n.parseNode);return a}else{var f=n.parseNode(o.find("> value > *").get(0));var l=new t(f.faultString);l.msg=l.message=f.faultString;l.type=l.code=f.faultCode;throw l}};n.parseNode=function(e){if(e===undefined){return null}var t=e.nodeName.toLowerCase();if(t in n.types){return n.types[t].decode(e)}else{throw new Error("Unknown type "+t)}};n.parseValue=function(t){var r=e(t).children()[0];if(r){return n.parseNode(r)}else{return e(t).text()}};var i=function(){};e.xmlrpc.types={};n.makeType=function(t,r,s,o){var u;u=function(e){this.value=e};u.prototype=new i;u.prototype.tagName=t;if(r){var a=s,f=o;s=function(e,t){var n=a(e);return t(u.tagName).text(n)};o=function(t){return f(e(t).text(),t)}}u.prototype.toXmlRpc=function(e){return u.encode(this.value,e)};u.tagName=t;u.encode=s;u.decode=o;n.types[t.toLowerCase()]=u};var s=function(e){return""+Math.floor(e)};var o=function(e,t){return parseInt(e,10)};n.makeType("int",true,s,o);n.makeType("i4",true,s,o);n.makeType("i8",true,s,o);n.makeType("i16",true,s,o);n.makeType("i32",true,s,o);n.makeType("double",true,String,function(e){return parseFloat(e,10)});n.makeType("string",true,String,String);n.makeType("boolean",true,function(e){return e?"1":"0"},function(e){return e==="1"});var u=function(e){return e<10?"0"+e:e};n.makeType("dateTime.iso8601",true,function(e){return[e.getUTCFullYear(),"-",u(e.getUTCMonth()+1),"-",u(e.getUTCDate()),"T",u(e.getUTCHours()),":",u(e.getUTCMinutes()),":",u(e.getUTCSeconds()),"Z"].join("")},function(e){return new Date(e)});n.binary=function(){var e="=";var t=("ABCDEFGHIJKLMNOPQRSTUVWXYZ"+"abcdefghijklmnopqrstuvwxyz0123456789+/").split("");var n=t.reduce(function(e,t,n){e[t]=n;return e},{});return{toBase64:function(n){var r=[];var i=new Uint8Array(n);var s=0,o;for(;s<i.length;s+=3){o=(i[s+0]<<16)+(i[s+1]<<8)+(i[s+2]<<0);r.push(t[(o>>18)%64]);r.push(t[(o>>12)%64]);r.push(t[(o>>6)%64]);r.push(t[(o>>0)%64])}var u=3-(n.byteLength%3||3);while(u--){r[r.length-u-1]=e}return r.join("")},fromBase64:function(t){var r=t.length;var i=r/4*3;if(t.charAt(r-1)===e){i--}if(t.charAt(r-2)===e){i--}var s=new ArrayBuffer(i);var o=new Uint8Array(s);var u=0,a=0,f;for(;u<r;u+=4,a+=3){f=(n[t[u+0]]<<18)+(n[t[u+1]]<<12)+(n[t[u+2]]<<6)+(n[t[u+3]]<<0);o[a+0]=(f>>16)%256;o[a+1]=(f>>8)%256;o[a+2]=(f>>0)%256}return s}}}();n.makeType("base64",true,function(e){return n.binary.toBase64(e)},function(e){return n.binary.fromBase64(e)});n.makeType("nil",false,function(e,t){return t("nil")},function(e){return null});n.makeType("struct",false,function(t,r){var i=r("struct");e.each(t,function(e,t){var s=r("name").text(e);var o=r("value").append(n.toXmlRpc(t,r));i.append(r("member").append(s,o))});return i},function(t){return e(t).find("> member").toArray().reduce(function(t,r){var i=e(r);var s=i.find("> name").text();var o=n.parseValue(i.find("> value"));t[s]=o;return t},{})});n.makeType("array",false,function(t,r){var i=r("array");var s=r("data");e.each(t,function(e,t){s.append(r("value").append(n.toXmlRpc(t,r)))});i.append(s);return i},function(t){return e(t).find("> data > value").toArray().map(n.parseValue)});n.force=function(e,t){return new n.types[e](t)}})(jQuery)